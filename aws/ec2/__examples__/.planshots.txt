

An execution plan has been generated and is shown below.
Resource actions are indicated with the following symbols:
+ create

Terraform will perform the following actions:

+ aws_iam_instance_profile.with-iam-instance-profile
id:                                        <computed>
arn:                                       <computed>
create_date:                               <computed>
name:                                      "with-iam-instance-profile"
path:                                      "/"
role:                                      <computed>
roles.#:                                   <computed>
unique_id:                                 <computed>

+ module.with-ami.aws_instance.mod[0]
id:                                        <computed>
ami:                                       "with-ami"
arn:                                       <computed>
associate_public_ip_address:               "true"
availability_zone:                         <computed>
cpu_core_count:                            <computed>
cpu_threads_per_core:                      <computed>
ebs_block_device.#:                        <computed>
ebs_optimized:                             "false"
ephemeral_block_device.#:                  <computed>
get_password_data:                         "false"
instance_state:                            <computed>
instance_type:                             "t2.small"
ipv6_address_count:                        <computed>
ipv6_addresses.#:                          <computed>
key_name:                                  "with-ami"
network_interface.#:                       <computed>
network_interface_id:                      <computed>
password_data:                             <computed>
placement_group:                           <computed>
primary_network_interface_id:              <computed>
private_dns:                               <computed>
private_ip:                                <computed>
public_dns:                                <computed>
public_ip:                                 <computed>
root_block_device.#:                       "1"
root_block_device.0.delete_on_termination: "true"
root_block_device.0.volume_id:             <computed>
root_block_device.0.volume_size:           "16"
root_block_device.0.volume_type:           "gp2"
security_groups.#:                         <computed>
source_dest_check:                         "true"
subnet_id:                                 "with-ami"
tags.%:                                    "2"
tags.Environment:                          "production"
tags.Name:                                 "with-ami01"
tenancy:                                   <computed>
volume_tags.%:                             <computed>
vpc_security_group_ids.#:                  <computed>

+ module.with-ami.aws_instance.mod[1]
id:                                        <computed>
ami:                                       "with-ami"
arn:                                       <computed>
associate_public_ip_address:               "true"
availability_zone:                         <computed>
cpu_core_count:                            <computed>
cpu_threads_per_core:                      <computed>
ebs_block_device.#:                        <computed>
ebs_optimized:                             "false"
ephemeral_block_device.#:                  <computed>
get_password_data:                         "false"
instance_state:                            <computed>
instance_type:                             "t2.small"
ipv6_address_count:                        <computed>
ipv6_addresses.#:                          <computed>
key_name:                                  "with-ami"
network_interface.#:                       <computed>
network_interface_id:                      <computed>
password_data:                             <computed>
placement_group:                           <computed>
primary_network_interface_id:              <computed>
private_dns:                               <computed>
private_ip:                                <computed>
public_dns:                                <computed>
public_ip:                                 <computed>
root_block_device.#:                       "1"
root_block_device.0.delete_on_termination: "true"
root_block_device.0.volume_id:             <computed>
root_block_device.0.volume_size:           "16"
root_block_device.0.volume_type:           "gp2"
security_groups.#:                         <computed>
source_dest_check:                         "true"
subnet_id:                                 "with-ami"
tags.%:                                    "2"
tags.Environment:                          "production"
tags.Name:                                 "with-ami02"
tenancy:                                   <computed>
volume_tags.%:                             <computed>
vpc_security_group_ids.#:                  <computed>

+ module.with-ami.aws_security_group.security_group_on_instances
id:                                        <computed>
arn:                                       <computed>
description:                               "Managed by Terraform"
egress.#:                                  <computed>
ingress.#:                                 <computed>
name:                                      "with-ami-ec2-instances"
owner_id:                                  <computed>
revoke_rules_on_delete:                    "false"
tags.%:                                    "1"
tags.Name:                                 "with-ami-ec2-instances"
vpc_id:                                    "vpc_abc123"

+ module.with-ami.aws_security_group_rule.all_egress_on_instances_to_anywhere
id:                                        <computed>
cidr_blocks.#:                             "1"
cidr_blocks.0:                             "0.0.0.0/0"
from_port:                                 "0"
protocol:                                  "-1"
security_group_id:                         "${aws_security_group.security_group_on_instances.id}"
self:                                      "false"
source_security_group_id:                  <computed>
to_port:                                   "0"
type:                                      "egress"

+ module.with-ami.aws_security_group_rule.all_ingress_on_instances_from_self
id:                                        <computed>
from_port:                                 "0"
protocol:                                  "-1"
security_group_id:                         "${aws_security_group.security_group_on_instances.id}"
self:                                      "true"
source_security_group_id:                  <computed>
to_port:                                   "0"
type:                                      "ingress"

+ module.with-ami.aws_security_group_rule.ssh_ingress_on_instances_from_anywhere
id:                                        <computed>
cidr_blocks.#:                             "1"
cidr_blocks.0:                             "0.0.0.0/0"
from_port:                                 "22"
protocol:                                  "tcp"
security_group_id:                         "${aws_security_group.security_group_on_instances.id}"
self:                                      "false"
source_security_group_id:                  <computed>
to_port:                                   "22"
type:                                      "ingress"

+ module.with-eip.aws_eip.mod[0]
id:                                        <computed>
allocation_id:                             <computed>
association_id:                            <computed>
domain:                                    <computed>
instance:                                  "${element(aws_instance.mod.*.id, count.index)}"
network_interface:                         <computed>
private_ip:                                <computed>
public_ip:                                 <computed>
vpc:                                       "true"

+ module.with-eip.aws_eip.mod[1]
id:                                        <computed>
allocation_id:                             <computed>
association_id:                            <computed>
domain:                                    <computed>
instance:                                  "${element(aws_instance.mod.*.id, count.index)}"
network_interface:                         <computed>
private_ip:                                <computed>
public_ip:                                 <computed>
vpc:                                       "true"

+ module.with-eip.aws_instance.mod[0]
id:                                        <computed>
ami:                                       "ami-0ff8a91507f77f867"
arn:                                       <computed>
associate_public_ip_address:               "true"
availability_zone:                         <computed>
cpu_core_count:                            <computed>
cpu_threads_per_core:                      <computed>
ebs_block_device.#:                        <computed>
ebs_optimized:                             "false"
ephemeral_block_device.#:                  <computed>
get_password_data:                         "false"
instance_state:                            <computed>
instance_type:                             "t2.small"
ipv6_address_count:                        <computed>
ipv6_addresses.#:                          <computed>
key_name:                                  "without-ami"
network_interface.#:                       <computed>
network_interface_id:                      <computed>
password_data:                             <computed>
placement_group:                           <computed>
primary_network_interface_id:              <computed>
private_dns:                               <computed>
private_ip:                                <computed>
public_dns:                                <computed>
public_ip:                                 <computed>
root_block_device.#:                       "1"
root_block_device.0.delete_on_termination: "true"
root_block_device.0.volume_id:             <computed>
root_block_device.0.volume_size:           "16"
root_block_device.0.volume_type:           "gp2"
security_groups.#:                         <computed>
source_dest_check:                         "true"
subnet_id:                                 "without-ami"
tags.%:                                    "2"
tags.Environment:                          "production"
tags.Name:                                 "without-ami01"
tenancy:                                   <computed>
volume_tags.%:                             <computed>
vpc_security_group_ids.#:                  <computed>

+ module.with-eip.aws_instance.mod[1]
id:                                        <computed>
ami:                                       "ami-0ff8a91507f77f867"
arn:                                       <computed>
associate_public_ip_address:               "true"
availability_zone:                         <computed>
cpu_core_count:                            <computed>
cpu_threads_per_core:                      <computed>
ebs_block_device.#:                        <computed>
ebs_optimized:                             "false"
ephemeral_block_device.#:                  <computed>
get_password_data:                         "false"
instance_state:                            <computed>
instance_type:                             "t2.small"
ipv6_address_count:                        <computed>
ipv6_addresses.#:                          <computed>
key_name:                                  "without-ami"
network_interface.#:                       <computed>
network_interface_id:                      <computed>
password_data:                             <computed>
placement_group:                           <computed>
primary_network_interface_id:              <computed>
private_dns:                               <computed>
private_ip:                                <computed>
public_dns:                                <computed>
public_ip:                                 <computed>
root_block_device.#:                       "1"
root_block_device.0.delete_on_termination: "true"
root_block_device.0.volume_id:             <computed>
root_block_device.0.volume_size:           "16"
root_block_device.0.volume_type:           "gp2"
security_groups.#:                         <computed>
source_dest_check:                         "true"
subnet_id:                                 "without-ami"
tags.%:                                    "2"
tags.Environment:                          "production"
tags.Name:                                 "without-ami02"
tenancy:                                   <computed>
volume_tags.%:                             <computed>
vpc_security_group_ids.#:                  <computed>

+ module.with-eip.aws_security_group.security_group_on_instances
id:                                        <computed>
arn:                                       <computed>
description:                               "Managed by Terraform"
egress.#:                                  <computed>
ingress.#:                                 <computed>
name:                                      "without-ami-ec2-instances"
owner_id:                                  <computed>
revoke_rules_on_delete:                    "false"
tags.%:                                    "1"
tags.Name:                                 "without-ami-ec2-instances"
vpc_id:                                    "vpc_abc123"

+ module.with-eip.aws_security_group_rule.all_egress_on_instances_to_anywhere
id:                                        <computed>
cidr_blocks.#:                             "1"
cidr_blocks.0:                             "0.0.0.0/0"
from_port:                                 "0"
protocol:                                  "-1"
security_group_id:                         "${aws_security_group.security_group_on_instances.id}"
self:                                      "false"
source_security_group_id:                  <computed>
to_port:                                   "0"
type:                                      "egress"

+ module.with-eip.aws_security_group_rule.all_ingress_on_instances_from_self
id:                                        <computed>
from_port:                                 "0"
protocol:                                  "-1"
security_group_id:                         "${aws_security_group.security_group_on_instances.id}"
self:                                      "true"
source_security_group_id:                  <computed>
to_port:                                   "0"
type:                                      "ingress"

+ module.with-eip.aws_security_group_rule.ssh_ingress_on_instances_from_anywhere
id:                                        <computed>
cidr_blocks.#:                             "1"
cidr_blocks.0:                             "0.0.0.0/0"
from_port:                                 "22"
protocol:                                  "tcp"
security_group_id:                         "${aws_security_group.security_group_on_instances.id}"
self:                                      "false"
source_security_group_id:                  <computed>
to_port:                                   "22"
type:                                      "ingress"

+ module.with-iam-instance-profile.aws_instance.mod[0]
id:                                        <computed>
ami:                                       "ami-0ff8a91507f77f867"
arn:                                       <computed>
associate_public_ip_address:               "true"
availability_zone:                         <computed>
cpu_core_count:                            <computed>
cpu_threads_per_core:                      <computed>
ebs_block_device.#:                        <computed>
ebs_optimized:                             "false"
ephemeral_block_device.#:                  <computed>
get_password_data:                         "false"
iam_instance_profile:                      "${var.iam_instance_profile}"
instance_state:                            <computed>
instance_type:                             "t2.small"
ipv6_address_count:                        <computed>
ipv6_addresses.#:                          <computed>
key_name:                                  "without-ami"
network_interface.#:                       <computed>
network_interface_id:                      <computed>
password_data:                             <computed>
placement_group:                           <computed>
primary_network_interface_id:              <computed>
private_dns:                               <computed>
private_ip:                                <computed>
public_dns:                                <computed>
public_ip:                                 <computed>
root_block_device.#:                       "1"
root_block_device.0.delete_on_termination: "true"
root_block_device.0.volume_id:             <computed>
root_block_device.0.volume_size:           "16"
root_block_device.0.volume_type:           "gp2"
security_groups.#:                         <computed>
source_dest_check:                         "true"
subnet_id:                                 "without-ami"
tags.%:                                    "2"
tags.Environment:                          "production"
tags.Name:                                 "without-ami01"
tenancy:                                   <computed>
volume_tags.%:                             <computed>
vpc_security_group_ids.#:                  <computed>

+ module.with-iam-instance-profile.aws_instance.mod[1]
id:                                        <computed>
ami:                                       "ami-0ff8a91507f77f867"
arn:                                       <computed>
associate_public_ip_address:               "true"
availability_zone:                         <computed>
cpu_core_count:                            <computed>
cpu_threads_per_core:                      <computed>
ebs_block_device.#:                        <computed>
ebs_optimized:                             "false"
ephemeral_block_device.#:                  <computed>
get_password_data:                         "false"
iam_instance_profile:                      "${var.iam_instance_profile}"
instance_state:                            <computed>
instance_type:                             "t2.small"
ipv6_address_count:                        <computed>
ipv6_addresses.#:                          <computed>
key_name:                                  "without-ami"
network_interface.#:                       <computed>
network_interface_id:                      <computed>
password_data:                             <computed>
placement_group:                           <computed>
primary_network_interface_id:              <computed>
private_dns:                               <computed>
private_ip:                                <computed>
public_dns:                                <computed>
public_ip:                                 <computed>
root_block_device.#:                       "1"
root_block_device.0.delete_on_termination: "true"
root_block_device.0.volume_id:             <computed>
root_block_device.0.volume_size:           "16"
root_block_device.0.volume_type:           "gp2"
security_groups.#:                         <computed>
source_dest_check:                         "true"
subnet_id:                                 "without-ami"
tags.%:                                    "2"
tags.Environment:                          "production"
tags.Name:                                 "without-ami02"
tenancy:                                   <computed>
volume_tags.%:                             <computed>
vpc_security_group_ids.#:                  <computed>

+ module.with-iam-instance-profile.aws_security_group.security_group_on_instances
id:                                        <computed>
arn:                                       <computed>
description:                               "Managed by Terraform"
egress.#:                                  <computed>
ingress.#:                                 <computed>
name:                                      "without-ami-ec2-instances"
owner_id:                                  <computed>
revoke_rules_on_delete:                    "false"
tags.%:                                    "1"
tags.Name:                                 "without-ami-ec2-instances"
vpc_id:                                    "vpc_abc123"

+ module.with-iam-instance-profile.aws_security_group_rule.all_egress_on_instances_to_anywhere
id:                                        <computed>
cidr_blocks.#:                             "1"
cidr_blocks.0:                             "0.0.0.0/0"
from_port:                                 "0"
protocol:                                  "-1"
security_group_id:                         "${aws_security_group.security_group_on_instances.id}"
self:                                      "false"
source_security_group_id:                  <computed>
to_port:                                   "0"
type:                                      "egress"

+ module.with-iam-instance-profile.aws_security_group_rule.all_ingress_on_instances_from_self
id:                                        <computed>
from_port:                                 "0"
protocol:                                  "-1"
security_group_id:                         "${aws_security_group.security_group_on_instances.id}"
self:                                      "true"
source_security_group_id:                  <computed>
to_port:                                   "0"
type:                                      "ingress"

+ module.with-iam-instance-profile.aws_security_group_rule.ssh_ingress_on_instances_from_anywhere
id:                                        <computed>
cidr_blocks.#:                             "1"
cidr_blocks.0:                             "0.0.0.0/0"
from_port:                                 "22"
protocol:                                  "tcp"
security_group_id:                         "${aws_security_group.security_group_on_instances.id}"
self:                                      "false"
source_security_group_id:                  <computed>
to_port:                                   "22"
type:                                      "ingress"
Plan: 21 to add, 0 to change, 0 to destroy.

